(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-105465f6"],{"0e017":function(e,t,a){"use strict";a("7d39")},"1db0":function(e,t,a){"use strict";a.r(t);var l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"article"},[a("h1",{staticClass:"manage-title"},[e._v("文章管理")]),a("div",{staticClass:"search"},[a("CreateForm",{attrs:{"label-width":"80px","data-source":e.searchForm},on:{onOk:e.handleOk}},[a("template",{slot:"btn"},[a("el-button",{attrs:{size:"small"},on:{click:function(t){return e.$router.push("/manage/article/create")}}},[e._v("写文章")])],1)],2)],1),a("el-table",{attrs:{data:e.lists}},[a("el-table-column",{attrs:{label:"标题",prop:"title"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("router-link",{attrs:{to:"/manage/article/"+t.row._id}},[e._v(e._s(t.row.title))])]}}])}),a("el-table-column",{attrs:{label:"分类",prop:"categoryName",width:"80"}}),a("el-table-column",{attrs:{label:"标签",prop:"tag",width:"140"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticClass:"tag-box"},e._l((t.row.tag||"").split(",").filter((function(e){return e})),(function(t){return a("span",{key:t,staticClass:"tag"},[e._v(e._s(t))])})),0)]}}])}),a("el-table-column",{attrs:{label:"是否禁用",prop:"disabled",width:"140"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-switch",{attrs:{"active-value":0,"inactive-value":1,"active-text":"启用","inactive-text":"禁用"},on:{change:function(a){return e.disabledArticle(t.row._id,a)}},model:{value:t.row.disabled,callback:function(a){e.$set(t.row,"disabled",a)},expression:"scope.row.disabled"}})]}}])}),a("el-table-column",{attrs:{label:"浏览量",prop:"view",width:"100"}}),a("el-table-column",{attrs:{label:"点赞数",prop:"like",width:"100"}}),a("el-table-column",{attrs:{label:"点踩数",prop:"dislike",width:"100"}}),a("el-table-column",{attrs:{label:"更新时间",prop:"updateTime"}}),a("el-table-column",{attrs:{label:"创建时间",prop:"createTime"}}),a("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{staticClass:"red",attrs:{type:"text"},on:{click:function(a){return e.deleteItem(t.row)}}},[e._v("删除")])]}}])})],1),e.page.total>e.page.limit?a("div",{staticClass:"pagination"},[a("el-pagination",{attrs:{background:"",layout:"prev, pager, next",total:e.page.total},on:{"current-change":e.pageChange}})],1):e._e()],1)},r=[],o=a("5530"),i=(a("d81d"),a("b0c0"),a("7b0d")),n=a("c1df"),s=a.n(n),c=a("6fa2"),u={name:"manageArticle",components:{CreateForm:i["a"]},data:function(){return{lists:[],page:{page:1,limit:10,total:0,disabled:0},searchForm:{main:[{type:"input",key:"keyword",label:"关键字"},{type:"select",key:"disabled",label:"状态",default:0,options:[{value:0,label:"启用"},{value:1,label:"禁用"},{value:2,label:"所有"}]}],more:[{type:"cascader",key:"category",label:"分类",options:[]},{type:"input",key:"tag",label:"标签",placeholder:"逗号分隔标签"}]}}},mounted:function(){var e=this;this.apiGet("/api/category/list/all").then((function(t){200===t.code&&(e.searchForm.more[0].options=Object(c["b"])(t.data,{label:"name",value:"_id"}),e.searchForm=Object(o["a"])({},e.searchForm))})),this.getData()},methods:{getData:function(){var e=this;this.apiPost("/api/article/list/all",this.page).then((function(t){200===t.code&&(e.lists=t.data.map((function(e){var t;return Object(o["a"])(Object(o["a"])({},e),{},{categoryName:null===(t=e.category)||void 0===t?void 0:t.name,updateTime:s()(e.updateTime).format("YYYY-MM-DD HH:mm:ss"),createTime:s()(e.createTime).format("YYYY-MM-DD HH:mm:ss")})})),e.page.total=t.total)}))},pageChange:function(e){this.page.page=e,this.getData()},handleOk:function(e){this.page=Object(o["a"])(Object(o["a"])(Object(o["a"])({},this.page),e),{},{category:e.category&&e.category[e.category.length-1]}),this.getData()},disabledArticle:function(e,t){var a=this;this.apiPost("/api/article/".concat(e,"/disabled"),{disabled:t}).then((function(e){200===e.code&&a.$message.success("操作成功!")}))},deleteItem:function(e){var t=this;this.$confirm("您确定删除嘛? 该操作不可恢复").then((function(a){t.apiPost("/api/article/".concat(e._id,"/delete")).then((function(){t.getData(),t.$message.success("删除成功!")}))})).catch((function(){return t.$message.error("删除失败, 请稍后再试!")}))}}},m=u,p=(a("0e017"),a("2877")),f=Object(p["a"])(m,l,r,!1,null,"9af018b2",null);t["default"]=f.exports},"7b0d":function(e,t,a){"use strict";var l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":e.labelWidth,inline:e.inline}},[e._l(e.dataSource.main,(function(t,l){return a("el-form-item",{key:l,attrs:{label:t.label,prop:t.key}},[a("FormItem",{ref:"mainForm",refInFor:!0,attrs:{item:t,form:e.form}})],1)})),a("el-form-item",[e.showOk?a("el-button",{attrs:{type:"primary",plain:"",size:"small"},on:{click:e.handleOk}},[e._v(e._s(e.okText))]):e._e(),e.showReset?a("el-button",{attrs:{type:"warning",plain:"",size:"small"},on:{click:e.resetData}},[e._v(e._s(e.resetText))]):e._e(),e._t("btn")],2),e.dataSource.more?a("div",e._l(e.dataSource.more||[],(function(t,l){return a("el-form-item",{key:l,attrs:{label:t.label,prop:t.key}},[a("FormItem",{ref:"moreForm",refInFor:!0,attrs:{item:t,form:e.form}})],1)})),1):e._e()],2)},r=[],o=a("2909"),i=(a("d3b7"),a("159b"),a("99af"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return"input"===e.item.type?a("el-input",{attrs:{size:"small",disabled:e.item.disabled,type:e.item.inputType||"text",placeholder:e.item.placeholder},model:{value:e.form[e.item.key],callback:function(t){e.$set(e.form,e.item.key,t)},expression:"form[item.key]"}}):"select"===e.item.type?a("el-select",{attrs:{size:"small",multiple:e.item.multiple,clearable:e.item.clearable||!1,"multiple-limit":e.item.limit,placeholder:e.item.placeholder,filterable:e.item.filterable},model:{value:e.form[e.item.key],callback:function(t){e.$set(e.form,e.item.key,t)},expression:"form[item.key]"}},e._l(e.item.options,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1):"cascader"===e.item.type?a("el-cascader",{attrs:{size:"small",options:e.item.options,placeholder:e.item.placeholder,clearable:e.item.clearable,filterable:e.item.filterable,props:{checkStrictly:!0}},model:{value:e.form[e.item.key],callback:function(t){e.$set(e.form,e.item.key,t)},expression:"form[item.key]"}}):"searchSelect"===e.item.type?a("el-autocomplete",{attrs:{size:"small","value-key":e.displayAutoCompleteKey,"fetch-suggestions":e.querySearch,placeholder:"请输入内容"},on:{select:function(t){e.form[e.item.key]=t.value}},scopedSlots:e._u([{key:"default",fn:function(t){var l=t.item;return[a("span",[e._v(e._s(l.label))])]}}]),model:{value:e.autoComplete,callback:function(t){e.autoComplete=t},expression:"autoComplete"}}):e._e()}),n=[],s={name:"FormItem",props:{item:{type:Object,default:function(){return{}}},form:{type:Object,default:function(){return{}}},displayAutoCompleteKey:{type:String,default:"label"}},data:function(){return{autoComplete:""}},methods:{querySearch:function(e,t){this.item.callback&&this.item.callback(e,t)},reset:function(){this.autoComplete=""}}},c=s,u=a("2877"),m=Object(u["a"])(c,i,n,!1,null,"abc87b5e",null),p=m.exports,f={name:"CreateForm",components:{FormItem:p},props:{dataSource:{type:Object,default:function(){return{main:[],more:[]}}},labelWidth:{type:String,default:"100px"},rules:{type:Object,default:function(){return{}}},inline:{type:Boolean,default:!0},showOk:{type:Boolean,default:!0},showReset:{type:Boolean,default:!0},okText:{type:String,default:"搜索"},resetText:{type:String,default:"重置"}},data:function(){return{form:{}}},mounted:function(){this.setDefault()},methods:{handleOk:function(){var e=this;this.getData().then((function(t){e.$emit("onOk",t)}))},getData:function(){var e=this;return new Promise((function(t,a){e.$refs.form.validate((function(l){l?t(JSON.parse(JSON.stringify(e.form))):a(new Error("请填写完整"))}))}))},resetData:function(){this.$refs.form.resetFields(),(this.$refs.mainForm||[]).forEach((function(e){return e.reset()})),(this.$refs.moreForm||[]).forEach((function(e){return e.reset()})),this.setDefault()},setDefault:function(){var e=this;[].concat(Object(o["a"])(this.dataSource.main||[]),Object(o["a"])(this.dataSource.more||[])).forEach((function(t){"undefined"!==typeof t.default&&e.$set(e.form,t.key,t.default)}))}}},d=f,b=Object(u["a"])(d,l,r,!1,null,"1010fa3a",null);t["a"]=b.exports},"7d39":function(e,t,a){}}]);