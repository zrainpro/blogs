(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0977e399"],{"1db0":function(e,t,a){"use strict";a.r(t);a("4de4"),a("ac1f"),a("1276");var l=a("7a23");Object(l["O"])("data-v-9af018b2");var c={class:"article"},n=Object(l["n"])("h1",{class:"manage-title"},"文章管理",-1),o={class:"search"},r={slot:"btn"},i=Object(l["p"])("写文章"),u={"slot-scope":"scope"},b={"slot-scope":"scope"},s={class:"tag-box"},m={"slot-scope":"scope"},d={"slot-scope":"scope"},p=Object(l["p"])("删除"),f={key:0,class:"pagination"};function j(e,t,a,j,O,h){var y=Object(l["U"])("el-button"),k=Object(l["U"])("CreateForm"),g=Object(l["U"])("router-link"),v=Object(l["U"])("el-table-column"),w=Object(l["U"])("el-switch"),_=Object(l["U"])("el-table"),q=Object(l["U"])("el-pagination");return Object(l["L"])(),Object(l["m"])("div",c,[n,Object(l["n"])("div",o,[Object(l["q"])(k,{"label-width":"80px","data-source":O.searchForm,onOnOk:h.handleOk},{default:Object(l["jb"])((function(){return[Object(l["n"])("template",r,[Object(l["q"])(y,{size:"small",onClick:t[0]||(t[0]=function(t){return e.$router.push("/manage/article/create")})},{default:Object(l["jb"])((function(){return[i]})),_:1})])]})),_:1},8,["data-source","onOnOk"])]),Object(l["q"])(_,{data:O.lists},{default:Object(l["jb"])((function(){return[Object(l["q"])(v,{label:"标题",prop:"title"},{default:Object(l["jb"])((function(){return[Object(l["n"])("template",u,[Object(l["q"])(g,{to:"/manage/article/".concat(e.scope.row._id)},{default:Object(l["jb"])((function(){return[Object(l["p"])(Object(l["Y"])(e.scope.row.title),1)]})),_:1},8,["to"])])]})),_:1}),Object(l["q"])(v,{label:"分类",prop:"categoryName",width:"80"}),Object(l["q"])(v,{label:"标签",prop:"tag",width:"140"},{default:Object(l["jb"])((function(){return[Object(l["n"])("template",b,[Object(l["n"])("div",s,[(Object(l["L"])(!0),Object(l["m"])(l["b"],null,Object(l["S"])((e.scope.row.tag||"").split(",").filter((function(e){return e})),(function(e){return Object(l["L"])(),Object(l["m"])("span",{key:e,class:"tag"},Object(l["Y"])(e),1)})),128))])])]})),_:1}),Object(l["q"])(v,{label:"是否禁用",prop:"disabled",width:"140"},{default:Object(l["jb"])((function(){return[Object(l["n"])("template",m,[Object(l["q"])(w,{modelValue:e.scope.row.disabled,"onUpdate:modelValue":t[1]||(t[1]=function(t){return e.scope.row.disabled=t}),"active-value":0,"inactive-value":1,"active-text":"启用","inactive-text":"禁用",onChange:t[2]||(t[2]=function(t){return h.disabledArticle(e.scope.row._id,t)})},null,8,["modelValue"])])]})),_:1}),Object(l["q"])(v,{label:"浏览量",prop:"view",width:"100"}),Object(l["q"])(v,{label:"点赞数",prop:"like",width:"100"}),Object(l["q"])(v,{label:"点踩数",prop:"dislike",width:"100"}),Object(l["q"])(v,{label:"更新时间",prop:"updateTime"}),Object(l["q"])(v,{label:"创建时间",prop:"createTime"}),Object(l["q"])(v,{label:"操作"},{default:Object(l["jb"])((function(){return[Object(l["n"])("template",d,[Object(l["q"])(y,{type:"text",class:"red",onClick:t[3]||(t[3]=function(t){return h.deleteItem(e.scope.row)})},{default:Object(l["jb"])((function(){return[p]})),_:1})])]})),_:1})]})),_:1},8,["data"]),O.page.total>O.page.limit?(Object(l["L"])(),Object(l["m"])("div",f,[Object(l["q"])(q,{background:"",layout:"prev, pager, next",total:O.page.total,onCurrentChange:h.pageChange},null,8,["total","onCurrentChange"])])):Object(l["l"])("",!0)])}Object(l["M"])();var O=a("5530"),h=(a("d81d"),a("b0c0"),a("7b0d")),y=a("c1df"),k=a.n(y),g=a("6fa2"),v={name:"manageArticle",components:{CreateForm:h["a"]},data:function(){return{lists:[],page:{page:1,limit:10,total:0,disabled:0},searchForm:{main:[{type:"input",key:"keyword",label:"关键字"},{type:"select",key:"disabled",label:"状态",default:0,options:[{value:0,label:"启用"},{value:1,label:"禁用"},{value:2,label:"所有"}]}],more:[{type:"cascader",key:"category",label:"分类",options:[]},{type:"input",key:"tag",label:"标签",placeholder:"逗号分隔标签"}]}}},mounted:function(){var e=this;this.apiGet("/api/category/list/all").then((function(t){200===t.code&&(e.searchForm.more[0].options=Object(g["b"])(t.data,{label:"name",value:"_id"}),e.searchForm=Object(O["a"])({},e.searchForm))})),this.getData()},methods:{getData:function(){var e=this;this.apiPost("/api/article/list/all",this.page).then((function(t){200===t.code&&(e.lists=t.data.map((function(e){var t;return Object(O["a"])(Object(O["a"])({},e),{},{categoryName:null===(t=e.category)||void 0===t?void 0:t.name,updateTime:k()(e.updateTime).format("YYYY-MM-DD HH:mm:ss"),createTime:k()(e.createTime).format("YYYY-MM-DD HH:mm:ss")})})),e.page.total=t.total)}))},pageChange:function(e){this.page.page=e,this.getData()},handleOk:function(e){this.page=Object(O["a"])(Object(O["a"])(Object(O["a"])({},this.page),e),{},{category:e.category&&e.category[e.category.length-1]}),this.getData()},disabledArticle:function(e,t){var a=this;this.apiPost("/api/article/".concat(e,"/disabled"),{disabled:t}).then((function(e){200===e.code&&a.$message.success("操作成功!")}))},deleteItem:function(e){var t=this;this.$confirm("您确定删除嘛? 该操作不可恢复").then((function(a){t.apiPost("/api/article/".concat(e._id,"/delete")).then((function(){t.getData(),t.$message.success("删除成功!")}))})).catch((function(){return t.$message.error("删除失败, 请稍后再试!")}))}}};a("547d");v.render=j,v.__scopeId="data-v-9af018b2";t["default"]=v},"547d":function(e,t,a){"use strict";a("a970")},"7b0d":function(e,t,a){"use strict";var l=a("7a23"),c={key:0};function n(e,t,a,n,o,r){var i=Object(l["U"])("FormItem"),u=Object(l["U"])("el-form-item"),b=Object(l["U"])("el-button"),s=Object(l["U"])("el-form");return Object(l["L"])(),Object(l["k"])(s,{ref:"form",model:o.form,rules:a.rules,"label-width":a.labelWidth,inline:a.inline},{default:Object(l["jb"])((function(){return[(Object(l["L"])(!0),Object(l["m"])(l["b"],null,Object(l["S"])(a.dataSource.main,(function(e,t){return Object(l["L"])(),Object(l["k"])(u,{key:t,label:e.label,prop:e.key},{default:Object(l["jb"])((function(){return[Object(l["q"])(i,{ref:"mainForm",item:e,form:o.form},null,8,["item","form"])]})),_:2},1032,["label","prop"])})),128)),Object(l["q"])(u,null,{default:Object(l["jb"])((function(){return[a.showOk?(Object(l["L"])(),Object(l["k"])(b,{key:0,type:"primary",plain:"",size:"small",onClick:r.handleOk},{default:Object(l["jb"])((function(){return[Object(l["p"])(Object(l["Y"])(a.okText),1)]})),_:1},8,["onClick"])):Object(l["l"])("",!0),a.showReset?(Object(l["L"])(),Object(l["k"])(b,{key:1,type:"warning",plain:"",size:"small",onClick:r.resetData},{default:Object(l["jb"])((function(){return[Object(l["p"])(Object(l["Y"])(a.resetText),1)]})),_:1},8,["onClick"])):Object(l["l"])("",!0),Object(l["T"])(e.$slots,"btn")]})),_:3}),a.dataSource.more?(Object(l["L"])(),Object(l["m"])("div",c,[(Object(l["L"])(!0),Object(l["m"])(l["b"],null,Object(l["S"])(a.dataSource.more||[],(function(e,t){return Object(l["L"])(),Object(l["k"])(u,{key:t,label:e.label,prop:e.key},{default:Object(l["jb"])((function(){return[Object(l["q"])(i,{ref:"moreForm",item:e,form:o.form},null,8,["item","form"])]})),_:2},1032,["label","prop"])})),128))])):Object(l["l"])("",!0)]})),_:3},8,["model","rules","label-width","inline"])}var o=a("2909"),r=(a("d3b7"),a("159b"),a("99af"),{"slot-scope":"{ item: it }"});function i(e,t,a,c,n,o){var i=Object(l["U"])("el-input"),u=Object(l["U"])("el-option"),b=Object(l["U"])("el-select"),s=Object(l["U"])("el-cascader"),m=Object(l["U"])("el-autocomplete");return"input"===a.item.type?(Object(l["L"])(),Object(l["k"])(i,{key:0,modelValue:a.form[a.item.key],"onUpdate:modelValue":t[0]||(t[0]=function(e){return a.form[a.item.key]=e}),size:"small",disabled:a.item.disabled,type:a.item.inputType||"text",placeholder:a.item.placeholder},null,8,["modelValue","disabled","type","placeholder"])):"select"===a.item.type?(Object(l["L"])(),Object(l["k"])(b,{key:1,modelValue:a.form[a.item.key],"onUpdate:modelValue":t[1]||(t[1]=function(e){return a.form[a.item.key]=e}),size:"small",multiple:a.item.multiple,clearable:a.item.clearable||!1,"multiple-limit":a.item.limit,placeholder:a.item.placeholder,filterable:a.item.filterable},{default:Object(l["jb"])((function(){return[(Object(l["L"])(!0),Object(l["m"])(l["b"],null,Object(l["S"])(a.item.options,(function(e){return Object(l["L"])(),Object(l["k"])(u,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])})),128))]})),_:1},8,["modelValue","multiple","clearable","multiple-limit","placeholder","filterable"])):"cascader"===a.item.type?(Object(l["L"])(),Object(l["k"])(s,{key:2,modelValue:a.form[a.item.key],"onUpdate:modelValue":t[2]||(t[2]=function(e){return a.form[a.item.key]=e}),size:"small",options:a.item.options,placeholder:a.item.placeholder,clearable:a.item.clearable,filterable:a.item.filterable,props:{checkStrictly:!0}},null,8,["modelValue","options","placeholder","clearable","filterable"])):"searchSelect"===a.item.type?(Object(l["L"])(),Object(l["k"])(m,{key:3,modelValue:n.autoComplete,"onUpdate:modelValue":t[3]||(t[3]=function(e){return n.autoComplete=e}),size:"small","value-key":a.displayAutoCompleteKey,"fetch-suggestions":o.querySearch,placeholder:"请输入内容",onSelect:t[4]||(t[4]=function(e){return a.form[a.item.key]=e.value})},{default:Object(l["jb"])((function(){return[Object(l["n"])("template",r,[Object(l["n"])("span",null,Object(l["Y"])(e.it.label),1)])]})),_:1},8,["modelValue","value-key","fetch-suggestions"])):Object(l["l"])("",!0)}var u={name:"FormItem",props:{item:{type:Object,default:function(){return{}}},form:{type:Object,default:function(){return{}}},displayAutoCompleteKey:{type:String,default:"label"}},data:function(){return{autoComplete:""}},methods:{querySearch:function(e,t){this.item.callback&&this.item.callback(e,t)},reset:function(){this.autoComplete=""}}};u.render=i;var b=u,s={name:"CreateForm",components:{FormItem:b},props:{dataSource:{type:Object,default:function(){return{main:[],more:[]}}},labelWidth:{type:String,default:"100px"},rules:{type:Object,default:function(){return{}}},inline:{type:Boolean,default:!0},showOk:{type:Boolean,default:!0},showReset:{type:Boolean,default:!0},okText:{type:String,default:"搜索"},resetText:{type:String,default:"重置"}},data:function(){return{form:{}}},mounted:function(){this.setDefault()},methods:{handleOk:function(){var e=this;this.getData().then((function(t){e.$emit("onOk",t)}))},getData:function(){var e=this;return new Promise((function(t,a){e.$refs.form.validate((function(l){l?t(JSON.parse(JSON.stringify(e.form))):a(new Error("请填写完整"))}))}))},resetData:function(){this.$refs.form.resetFields(),(this.$refs.mainForm||[]).forEach((function(e){return e.reset()})),(this.$refs.moreForm||[]).forEach((function(e){return e.reset()})),this.setDefault()},setDefault:function(){var e=this;[].concat(Object(o["a"])(this.dataSource.main||[]),Object(o["a"])(this.dataSource.more||[])).forEach((function(t){"undefined"!==typeof t.default&&e.$set(e.form,t.key,t.default)}))}}};s.render=n;t["a"]=s},a970:function(e,t,a){}}]);