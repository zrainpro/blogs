(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-ac627bb0"],{"4d11":function(e,t,r){},"7b0d":function(e,t,r){"use strict";var n=r("7a23"),a={key:0};function o(e,t,r,o,i,c){var l=Object(n["U"])("FormItem"),u=Object(n["U"])("el-form-item"),s=Object(n["U"])("el-button"),f=Object(n["U"])("el-form");return Object(n["L"])(),Object(n["k"])(f,{ref:"form",model:i.form,rules:r.rules,"label-width":r.labelWidth,inline:r.inline},{default:Object(n["jb"])((function(){return[(Object(n["L"])(!0),Object(n["m"])(n["b"],null,Object(n["S"])(r.dataSource.main,(function(e,t){return Object(n["L"])(),Object(n["k"])(u,{key:t,label:e.label,prop:e.key},{default:Object(n["jb"])((function(){return[Object(n["q"])(l,{ref:"mainForm",item:e,form:i.form},null,8,["item","form"])]})),_:2},1032,["label","prop"])})),128)),Object(n["q"])(u,null,{default:Object(n["jb"])((function(){return[r.showOk?(Object(n["L"])(),Object(n["k"])(s,{key:0,type:"primary",plain:"",size:"small",onClick:c.handleOk},{default:Object(n["jb"])((function(){return[Object(n["p"])(Object(n["Y"])(r.okText),1)]})),_:1},8,["onClick"])):Object(n["l"])("",!0),r.showReset?(Object(n["L"])(),Object(n["k"])(s,{key:1,type:"warning",plain:"",size:"small",onClick:c.resetData},{default:Object(n["jb"])((function(){return[Object(n["p"])(Object(n["Y"])(r.resetText),1)]})),_:1},8,["onClick"])):Object(n["l"])("",!0),Object(n["T"])(e.$slots,"btn")]})),_:3}),r.dataSource.more?(Object(n["L"])(),Object(n["m"])("div",a,[(Object(n["L"])(!0),Object(n["m"])(n["b"],null,Object(n["S"])(r.dataSource.more||[],(function(e,t){return Object(n["L"])(),Object(n["k"])(u,{key:t,label:e.label,prop:e.key},{default:Object(n["jb"])((function(){return[Object(n["q"])(l,{ref:"moreForm",item:e,form:i.form},null,8,["item","form"])]})),_:2},1032,["label","prop"])})),128))])):Object(n["l"])("",!0)]})),_:3},8,["model","rules","label-width","inline"])}var i=r("2909"),c=(r("d3b7"),r("159b"),r("99af"),{"slot-scope":"{ item: it }"});function l(e,t,r,a,o,i){var l=Object(n["U"])("el-input"),u=Object(n["U"])("el-option"),s=Object(n["U"])("el-select"),f=Object(n["U"])("el-cascader"),h=Object(n["U"])("el-autocomplete");return"input"===r.item.type?(Object(n["L"])(),Object(n["k"])(l,{key:0,modelValue:r.form[r.item.key],"onUpdate:modelValue":t[0]||(t[0]=function(e){return r.form[r.item.key]=e}),size:"small",disabled:r.item.disabled,type:r.item.inputType||"text",placeholder:r.item.placeholder},null,8,["modelValue","disabled","type","placeholder"])):"select"===r.item.type?(Object(n["L"])(),Object(n["k"])(s,{key:1,modelValue:r.form[r.item.key],"onUpdate:modelValue":t[1]||(t[1]=function(e){return r.form[r.item.key]=e}),size:"small",multiple:r.item.multiple,clearable:r.item.clearable||!1,"multiple-limit":r.item.limit,placeholder:r.item.placeholder,filterable:r.item.filterable},{default:Object(n["jb"])((function(){return[(Object(n["L"])(!0),Object(n["m"])(n["b"],null,Object(n["S"])(r.item.options,(function(e){return Object(n["L"])(),Object(n["k"])(u,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])})),128))]})),_:1},8,["modelValue","multiple","clearable","multiple-limit","placeholder","filterable"])):"cascader"===r.item.type?(Object(n["L"])(),Object(n["k"])(f,{key:2,modelValue:r.form[r.item.key],"onUpdate:modelValue":t[2]||(t[2]=function(e){return r.form[r.item.key]=e}),size:"small",options:r.item.options,placeholder:r.item.placeholder,clearable:r.item.clearable,filterable:r.item.filterable,props:{checkStrictly:!0}},null,8,["modelValue","options","placeholder","clearable","filterable"])):"searchSelect"===r.item.type?(Object(n["L"])(),Object(n["k"])(h,{key:3,modelValue:o.autoComplete,"onUpdate:modelValue":t[3]||(t[3]=function(e){return o.autoComplete=e}),size:"small","value-key":r.displayAutoCompleteKey,"fetch-suggestions":i.querySearch,placeholder:"请输入内容",onSelect:t[4]||(t[4]=function(e){return r.form[r.item.key]=e.value})},{default:Object(n["jb"])((function(){return[Object(n["n"])("template",c,[Object(n["n"])("span",null,Object(n["Y"])(e.it.label),1)])]})),_:1},8,["modelValue","value-key","fetch-suggestions"])):Object(n["l"])("",!0)}var u={name:"FormItem",props:{item:{type:Object,default:function(){return{}}},form:{type:Object,default:function(){return{}}},displayAutoCompleteKey:{type:String,default:"label"}},data:function(){return{autoComplete:""}},methods:{querySearch:function(e,t){this.item.callback&&this.item.callback(e,t)},reset:function(){this.autoComplete=""}}};u.render=l;var s=u,f={name:"CreateForm",components:{FormItem:s},props:{dataSource:{type:Object,default:function(){return{main:[],more:[]}}},labelWidth:{type:String,default:"100px"},rules:{type:Object,default:function(){return{}}},inline:{type:Boolean,default:!0},showOk:{type:Boolean,default:!0},showReset:{type:Boolean,default:!0},okText:{type:String,default:"搜索"},resetText:{type:String,default:"重置"}},data:function(){return{form:{}}},mounted:function(){this.setDefault()},methods:{handleOk:function(){var e=this;this.getData().then((function(t){e.$emit("onOk",t)}))},getData:function(){var e=this;return new Promise((function(t,r){e.$refs.form.validate((function(n){n?t(JSON.parse(JSON.stringify(e.form))):r(new Error("请填写完整"))}))}))},resetData:function(){this.$refs.form.resetFields(),(this.$refs.mainForm||[]).forEach((function(e){return e.reset()})),(this.$refs.moreForm||[]).forEach((function(e){return e.reset()})),this.setDefault()},setDefault:function(){var e=this;[].concat(Object(i["a"])(this.dataSource.main||[]),Object(i["a"])(this.dataSource.more||[])).forEach((function(t){"undefined"!==typeof t.default&&e.$set(e.form,t.key,t.default)}))}}};f.render=o;t["a"]=f},"96cf":function(e,t){!function(t){"use strict";var r,n=Object.prototype,a=n.hasOwnProperty,o="function"===typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",c=o.asyncIterator||"@@asyncIterator",l=o.toStringTag||"@@toStringTag",u="object"===typeof e,s=t.regeneratorRuntime;if(s)u&&(e.exports=s);else{s=t.regeneratorRuntime=u?e.exports:{},s.wrap=O;var f="suspendedStart",h="suspendedYield",p="executing",d="completed",m={},b={};b[i]=function(){return this};var y=Object.getPrototypeOf,v=y&&y(y(V([])));v&&v!==n&&a.call(v,i)&&(b=v);var j=x.prototype=w.prototype=Object.create(b);k.prototype=j.constructor=x,x.constructor=k,x[l]=k.displayName="GeneratorFunction",s.isGeneratorFunction=function(e){var t="function"===typeof e&&e.constructor;return!!t&&(t===k||"GeneratorFunction"===(t.displayName||t.name))},s.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,x):(e.__proto__=x,l in e||(e[l]="GeneratorFunction")),e.prototype=Object.create(j),e},s.awrap=function(e){return{__await:e}},L(E.prototype),E.prototype[c]=function(){return this},s.AsyncIterator=E,s.async=function(e,t,r,n){var a=new E(O(e,t,r,n));return s.isGeneratorFunction(t)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},L(j),j[l]="Generator",j[i]=function(){return this},j.toString=function(){return"[object Generator]"},s.keys=function(e){var t=[];for(var r in e)t.push(r);return t.reverse(),function r(){while(t.length){var n=t.pop();if(n in e)return r.value=n,r.done=!1,r}return r.done=!0,r}},s.values=V,U.prototype={constructor:U,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=r,this.done=!1,this.delegate=null,this.method="next",this.arg=r,this.tryEntries.forEach(C),!e)for(var t in this)"t"===t.charAt(0)&&a.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=r)},stop:function(){this.done=!0;var e=this.tryEntries[0],t=e.completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(n,a){return c.type="throw",c.arg=e,t.next=n,a&&(t.method="next",t.arg=r),!!a}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],c=i.completion;if("root"===i.tryLoc)return n("end");if(i.tryLoc<=this.prev){var l=a.call(i,"catchLoc"),u=a.call(i,"finallyLoc");if(l&&u){if(this.prev<i.catchLoc)return n(i.catchLoc,!0);if(this.prev<i.finallyLoc)return n(i.finallyLoc)}else if(l){if(this.prev<i.catchLoc)return n(i.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return n(i.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&a.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var o=n;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var i=o?o.completion:{};return i.type=e,i.arg=t,o?(this.method="next",this.next=o.finallyLoc,m):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),C(r),m}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var a=n.arg;C(r)}return a}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:V(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=r),m}}}function O(e,t,r,n){var a=t&&t.prototype instanceof w?t:w,o=Object.create(a.prototype),i=new U(n||[]);return o._invoke=_(e,r,i),o}function g(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(n){return{type:"throw",arg:n}}}function w(){}function k(){}function x(){}function L(e){["next","throw","return"].forEach((function(t){e[t]=function(e){return this._invoke(t,e)}}))}function E(e){function t(r,n,o,i){var c=g(e[r],e,n);if("throw"!==c.type){var l=c.arg,u=l.value;return u&&"object"===typeof u&&a.call(u,"__await")?Promise.resolve(u.__await).then((function(e){t("next",e,o,i)}),(function(e){t("throw",e,o,i)})):Promise.resolve(u).then((function(e){l.value=e,o(l)}),i)}i(c.arg)}var r;function n(e,n){function a(){return new Promise((function(r,a){t(e,n,r,a)}))}return r=r?r.then(a,a):a()}this._invoke=n}function _(e,t,r){var n=f;return function(a,o){if(n===p)throw new Error("Generator is already running");if(n===d){if("throw"===a)throw o;return $()}r.method=a,r.arg=o;while(1){var i=r.delegate;if(i){var c=S(i,r);if(c){if(c===m)continue;return c}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(n===f)throw n=d,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n=p;var l=g(e,t,r);if("normal"===l.type){if(n=r.done?d:h,l.arg===m)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(n=d,r.method="throw",r.arg=l.arg)}}}function S(e,t){var n=e.iterator[t.method];if(n===r){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=r,S(e,t),"throw"===t.method))return m;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return m}var a=g(n,e.iterator,t.arg);if("throw"===a.type)return t.method="throw",t.arg=a.arg,t.delegate=null,m;var o=a.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=r),t.delegate=null,m):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,m)}function F(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function C(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function U(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(F,this),this.reset(!0)}function V(e){if(e){var t=e[i];if(t)return t.call(e);if("function"===typeof e.next)return e;if(!isNaN(e.length)){var n=-1,o=function t(){while(++n<e.length)if(a.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=r,t.done=!0,t};return o.next=o}}return{next:$}}function $(){return{value:r,done:!0}}}(function(){return this}()||Function("return this")())},d6b1:function(e,t,r){"use strict";r("4d11")},daf8:function(e,t,r){"use strict";r.r(t);var n=r("7a23");Object(n["O"])("data-v-62aebab4");var a={class:"edit-article"},o={class:"edit-article-operation"},i={class:"edit-article-tag"},c={class:"edit-article-info"},l=Object(n["p"])("暂存"),u=Object(n["p"])("发布");function s(e,t,r,s,f,h){var p=Object(n["U"])("CreateForm"),d=Object(n["U"])("el-button"),m=Object(n["U"])("el-input"),b=Object(n["U"])("Editor");return Object(n["L"])(),Object(n["m"])("div",a,[Object(n["n"])("div",o,[Object(n["n"])("div",i,[Object(n["q"])(p,{ref:"form","label-width":"50px","show-ok":!1,"show-reset":!1,"data-source":f.searchForm},null,8,["data-source"]),Object(n["n"])("span",c,"保存于 "+Object(n["Y"])(f.saveTime),1)]),Object(n["n"])("div",null,[Object(n["q"])(d,{type:"success",plain:"",size:"small",onClick:h.handleSave},{default:Object(n["jb"])((function(){return[l]})),_:1},8,["onClick"]),Object(n["q"])(d,{type:"primary",plain:"",size:"small",onClick:h.handlePublish},{default:Object(n["jb"])((function(){return[u]})),_:1},8,["onClick"])])]),Object(n["q"])(m,{modelValue:f.title,"onUpdate:modelValue":t[0]||(t[0]=function(e){return f.title=e}),size:"big",placeholder:"无标题",class:"edit-article-title"},null,8,["modelValue"]),Object(n["q"])(b,{ref:"editor",class:"editor"},null,512)])}Object(n["M"])();r("d3b7");function f(e,t,r,n,a,o,i){try{var c=e[o](i),l=c.value}catch(u){return void r(u)}c.done?t(l):Promise.resolve(l).then(n,a)}function h(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var o=e.apply(t,r);function i(e){f(o,n,a,i,c,"next",e)}function c(e){f(o,n,a,i,c,"throw",e)}i(void 0)}))}}var p=r("2909"),d=r("b85c"),m=r("5530"),b=(r("96cf"),r("095c")),y=r("7b0d"),v=r("c1df"),j=r.n(v),O=r("6fa2"),g={name:"EditArticle",components:{Editor:b["a"],CreateForm:y["a"]},data:function(){return{id:"",title:"",saveTime:j()().format("HH:mm:ss"),searchForm:{main:[{type:"cascader",key:"category",label:"分类",options:[]},{type:"input",key:"tag",label:"标签",placeholder:"逗号分隔标签"}]}}},mounted:function(){var e=this;this.apiGet("/api/category/list/all").then((function(t){200===t.code&&(e.options=Object(O["b"])(t.data,{label:"name",value:"_id"}),e.searchForm.main[0].options=e.options,e.searchForm=Object(m["a"])({},e.searchForm)),e.$route.params.id&&(e.id=e.$route.params.id,e.apiGet("/api/article/".concat(e.id,"/back/detail")).then((function(t){var r,n;200===t.code&&(e.title=null===(r=t.data)||void 0===r?void 0:r.title,e.$refs.editor.setValue(null===(n=t.data)||void 0===n?void 0:n.preserve),e.searchForm.main[0].default=e.parseCategory(t.data.category,e.options),e.searchForm.main[1].default=t.data.tag,e.$refs.form.setDefault())})))}))},methods:{parseCategory:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=[],a=Object(d["a"])(r);try{for(a.s();!(e=a.n()).done;){var o=e.value;if(o.value===t){n.push(o.value);break}if(o.children){var i=this.parseCategory(t,o.children);i&&i.length&&(n.push(o.value),n.push.apply(n,Object(p["a"])(i)))}}}catch(c){a.e(c)}finally{a.f()}return n},getData:function(){var e=this;return h(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$refs.form.getData();case 2:if(r=t.sent,r.category&&r.category.length){t.next=6;break}return e.$message.error("请选择分类"),t.abrupt("return");case 6:return t.abrupt("return",{category:r.category[r.category.length-1],tag:r.tag,preserve:e.$refs.editor.getValue(),title:e.title||"无标题",id:e.id});case 7:case"end":return t.stop()}}),t)})))()},handleSave:function(){var e=this;return h(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.getData();case 2:if(r=t.sent,r){t.next=5;break}return t.abrupt("return");case 5:e.apiPost("/api/article/preserve",r).then((function(t){200===t.code&&(e.$message.success("保存成功"),e.id=t.data._id)}));case 6:case"end":return t.stop()}}),t)})))()},handlePublish:function(){var e=this;return h(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.getData();case 2:if(r=t.sent,r){t.next=5;break}return t.abrupt("return");case 5:e.apiPost("/api/article/patch",Object(m["a"])(Object(m["a"])({},r),{},{content:r.preserve})).then((function(t){200===t.code&&e.$message.success("保存成功")}));case 6:case"end":return t.stop()}}),t)})))()}}};r("d6b1");g.render=s,g.__scopeId="data-v-62aebab4";t["default"]=g}}]);